{% extends "base.html" %}
{% load static %}

{% block extra_title %} | Dashboard {% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'dashboard/css/dashboard.css' %}">
{% endblock %}

{% block content %}
<div class="overlay"></div>
<div class="container dashboard-overlay">
    <div class="row">
        <div class="col text-center">
            <hr>
            <h2 class="logo-font mb-4">Dashboard</h2>
            <hr>
        </div>
    </div>

    <div class="row">
        <div class="col-md-3">
            <div class="card mb-4">
                <div class="card-header text-white bg-primary">
                    <h3>{{ profile.user.username }}'s Dashboard</h3>
                </div>
                <div class="card-body">
                    <ul class="nav flex-column">
                        <li class="nav-item mb-2">
                            <a class="nav-link btn btn-outline-primary" href="{% url 'dashboard:edit_profile' username=profile.user.username %}">Edit Profile</a>
                        </li>
                        {% if user_type == 'employer' %}
                        <li class="nav-item mb-2">
                            <a class="nav-link btn btn-outline-primary" href="{% url 'dashboard:post_job' %}">Post a Job</a>
                        </li>
                        {% endif %}
                        <li class="nav-item mb-2">
                            <a class="nav-link btn btn-outline-primary" href="{% url 'dashboard:view_profile' username=profile.user.username %}">View Profile</a>
                        </li>
                        <li class="nav-item mb-2">
                            <a class="nav-link btn btn-outline-primary" href="{% url 'subscription:subscribe' %}">Subscribe</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="col-md-9">
            <div class="card">
                <div class="card-body">
                    {% if user_type == 'freelancer' %}
                        <h2>Freelancer Details</h2>
                        <p><strong>Skills:</strong> 
                            <ul>
                                {% for skill in profile.skills.all %}
                                    <li>{{ skill.name }}</li>
                                {% endfor %}
                            </ul>
                        </p>
                        <p><strong>Bio:</strong> {{ profile.bio }}</p>
                        <p><strong>Phone Number:</strong> {{ profile.phone_number }}</p>
                        <p><strong>Available for Meetings:</strong> {{ profile.available_for_meetings }}</p>
                        <p><strong>Country:</strong> {{ profile.country }}</p>
                        <p><strong>Out of Office:</strong> {{ profile.out_of_office|yesno:"Yes,No" }}</p>
                        <p><strong>LinkedIn Profile:</strong> <a href="{{ profile.linkedin_profile }}" target="_blank">{{ profile.linkedin_profile }}</a></p>
                        <p><strong>Past Jobs Links:</strong>
                            <ul>
                                {% for job_link in profile.job_links.all %}
                                    <li><a href="{{ job_link.url }}">{{ job_link.url }}</a></li>
                                {% endfor %}
                            </ul>
                        </p>
                        {% if profile.profile_image %}
                            <img src="{{ profile.profile_image.url }}" alt="{{ profile.user.username }}'s Profile Picture" class="img-fluid rounded-circle" width="150" height="150">
                        {% endif %}
                    {% elif user_type == 'employer' %}
                        <h2>Employer Details</h2>
                        <p><strong>Company Name:</strong> {{ profile.company_name }}</p>
                        <p><strong>Phone Number:</strong> {{ profile.phone_number }}</p>
                        <p><strong>Company Address:</strong> {{ profile.company_address }}</p>
                        <p><strong>VAT Number:</strong> {{ profile.vat_number }}</p>
                        <p><strong>Country:</strong> {{ profile.country }}</p>
                    {% endif %}

                    <h2>Subscription Details</h2>
                    {% if subscription %}
                        <p><strong>Plan:</strong> {{ subscription.plan.name }}</p>
                        <p><strong>Status:</strong> {{ subscription.status }}</p>
                        <p><strong>Start Date:</strong> {{ subscription.start_date }}</p>
                        <p><strong>End Date:</strong> {{ subscription.end_date }}</p>
                    {% else %}
                        <p>No active subscription.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
